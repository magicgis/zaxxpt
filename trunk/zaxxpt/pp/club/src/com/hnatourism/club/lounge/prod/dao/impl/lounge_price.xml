<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="loungePrice">
	<typeAlias alias="loungePrice" type="com.hnatourism.club.lounge.prod.domain.LoungePrice" />
	<resultMap id="loungePriceResultMap" class="loungePrice">
		<result column="ID" property="id" />
		<result column="CODE" property="code" />
		<result column="ROOM_ID" property="roomId" />
		<result column="SIGNING_PRICE" property="signingPrice" />
		<result column="PRICE" property="price" />
		<result column="CHILDREN_PRICE" property="childrenPrice" />
		<result column="ITEM" property="item" />
		<result column="TYPE" property="type" />
		<result column="WAY" property="way" />
		<result column="STS" property="sts" />
		<result column="START_DATE" property="startDate" />
		<result column="END_DATE" property="endDate" />
		<result column="CREATE_USER" property="createUser" />
		<result column="CREATE_TIME" property="createTime" />
		<result column="UPDATE_USER" property="updateUser" />
		<result column="UPDATE_TIME" property="updateTime" />
		<result column="RESOURCES_TYPE" property="resources_type"/>
	</resultMap>
	<resultMap id="loungePriceResultMapHome" class="loungePrice">
		<result column="ID" property="id" />
		<result column="CODE" property="code" />
		<result column="ROOM_ID" property="roomId" />
		<result column="PRICE" property="price" />
	</resultMap>
	<resultMap id="loungePriceResultMapBook" class="loungePrice">
		<result column="ID" property="id" />
		<result column="CODE" property="code" />
		<result column="ROOM_ID" property="roomId" />
		<result column="PRICE" property="price" />
		<result column="ITEM" property="item" />
		<result column="CHILDREN_PRICE" property="childrenPrice" />
		<result column="SIGNING_PRICE" property="signingPrice" />
		<result column="TYPE" property="type" />
		<result column="WAY" property="way" />
	</resultMap>
	<sql id="selectLoungePriceSql">
		<![CDATA[
			SELECT T.RESOURCES_TYPE,T.ID,T.CODE,T.ROOM_ID,T.SIGNING_PRICE,T.PRICE,T.CHILDREN_PRICE,T.ITEM,T.TYPE,T.WAY,T.STS,T.START_DATE,T.END_DATE,T.CREATE_USER,T.CREATE_TIME,T.UPDATE_USER,T.UPDATE_TIME 
			FROM LOUNGE_PRICE T
		]]>
	</sql>
	<select id="findLoungePriceByWhere" parameterClass="loungePrice" resultMap="loungePriceResultMap">
		<include refid="selectLoungePriceSql"/>	
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="code">
				T.CODE=#code#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="roomId">
				T.ROOM_ID=#roomId#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="signingPrice">
				T.SIGNING_PRICE=#signingPrice#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="price">
				T.PRICE=#price#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="childrenPrice">
				T.CHILDREN_PRICE=#childrenPrice#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="item">
				T.ITEM=#item#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="type">
				T.TYPE=#type#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="way">
				T.WAY=#way#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="sts">
				T.STS=#sts#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="startDate">
				T.START_DATE=#startDate#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="endDate">
				T.END_DATE=#endDate#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="createUser">
				T.CREATE_USER=#createUser#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="createTime">
				T.CREATE_TIME=#createTime#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="updateUser">
				T.UPDATE_USER=#updateUser#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="updateTime">
				T.UPDATE_TIME=#updateTime#
			</isNotEmpty>
		</dynamic>
	</select>
	<!-- 不包含收费项目价格 -->
	<select id="findLoungePriceById" parameterClass="java.lang.String" resultMap="loungePriceResultMap">
		<include refid="selectLoungePriceSql"/>	
		<![CDATA[
			WHERE T.ID=#id# AND T.TYPE<>'S' AND T.STS=1
		]]>
	</select>
	<select id="findLoungePriceByRoomMin" parameterClass="loungePrice" resultMap="loungePriceResultMapHome">
		<include refid="selectLoungePriceSql"/>	
		<![CDATA[
			WHERE T.PRICE=(SELECT MIN(P.PRICE) FROM LOUNGE_PRICE P WHERE P.ROOM_ID=#roomId# AND P.TYPE<>'S' AND P.STS=1)
		]]>
	</select>
	<select id="findLoungePriceByRoom" parameterClass="loungePrice" resultMap="loungePriceResultMapBook">
		<include refid="selectLoungePriceSql"/>	
		<![CDATA[
			WHERE T.ROOM_ID=#roomId# AND T.STS=1  ORDER BY T.PRICE
		]]>
	</select>
	<select id="findLoungePriceByRoomTypeN" parameterClass="loungePrice" resultMap="loungePriceResultMapBook">
		<include refid="selectLoungePriceSql"/>	
		<![CDATA[
			WHERE T.ROOM_ID=#roomId# AND T.TYPE='N' AND T.STS=1
		]]>
	</select>
	<select id="findLoungePriceByRoomTypeS" parameterClass="loungePrice" resultMap="loungePriceResultMapBook">
		<include refid="selectLoungePriceSql"/>	
		<![CDATA[
			WHERE T.ROOM_ID=#roomId# AND T.TYPE='S' AND T.STS=1 AND INSTR(T.RESOURCES_TYPE,#roomType#)>0
		]]>
	</select>
	<insert id="insertLoungePrice" parameterClass="loungePrice">
		INSERT INTO LOUNGE_PRICE
		<dynamic prepend="(">
			<isNotEmpty prepend="," property="id">
				ID
			</isNotEmpty>

			<isNotEmpty prepend="," property="code">
				CODE
			</isNotEmpty>

			<isNotEmpty prepend="," property="roomId">
				ROOM_ID
			</isNotEmpty>

			<isNotEmpty prepend="," property="signingPrice">
				SIGNING_PRICE
			</isNotEmpty>

			<isNotEmpty prepend="," property="price">
				PRICE
			</isNotEmpty>

			<isNotEmpty prepend="," property="childrenPrice">
				CHILDREN_PRICE
			</isNotEmpty>

			<isNotEmpty prepend="," property="item">
				ITEM
			</isNotEmpty>

			<isNotEmpty prepend="," property="type">
				TYPE
			</isNotEmpty>

			<isNotEmpty prepend="," property="way">
				WAY
			</isNotEmpty>

			<isNotEmpty prepend="," property="sts">
				STS
			</isNotEmpty>

			<isNotEmpty prepend="," property="startDate">
				START_DATE
			</isNotEmpty>

			<isNotEmpty prepend="," property="endDate">
				END_DATE
			</isNotEmpty>

			<isNotEmpty prepend="," property="createUser">
				CREATE_USER
			</isNotEmpty>

			<isNotEmpty prepend="," property="createTime">
				CREATE_TIME
			</isNotEmpty>

			<isNotEmpty prepend="," property="updateUser">
				UPDATE_USER
			</isNotEmpty>

			<isNotEmpty prepend="," property="updateTime">
				UPDATE_TIME
			</isNotEmpty>

		</dynamic>		
		<dynamic prepend=") VALUES (">

			<isNotEmpty prepend="," property="id">
				#id#
			</isNotEmpty>


			<isNotEmpty prepend="," property="code">
				#code#
			</isNotEmpty>


			<isNotEmpty prepend="," property="roomId">
				#roomId#
			</isNotEmpty>


			<isNotEmpty prepend="," property="signingPrice">
				#signingPrice#
			</isNotEmpty>


			<isNotEmpty prepend="," property="price">
				#price#
			</isNotEmpty>


			<isNotEmpty prepend="," property="childrenPrice">
				#childrenPrice#
			</isNotEmpty>


			<isNotEmpty prepend="," property="item">
				#item#
			</isNotEmpty>


			<isNotEmpty prepend="," property="type">
				#type#
			</isNotEmpty>


			<isNotEmpty prepend="," property="way">
				#way#
			</isNotEmpty>


			<isNotEmpty prepend="," property="sts">
				#sts#
			</isNotEmpty>


			<isNotEmpty prepend="," property="startDate">
				#startDate#
			</isNotEmpty>


			<isNotEmpty prepend="," property="endDate">
				#endDate#
			</isNotEmpty>


			<isNotEmpty prepend="," property="createUser">
				#createUser#
			</isNotEmpty>


			<isNotEmpty prepend="," property="createTime">
				#createTime#
			</isNotEmpty>


			<isNotEmpty prepend="," property="updateUser">
				#updateUser#
			</isNotEmpty>


			<isNotEmpty prepend="," property="updateTime">
				#updateTime#
			</isNotEmpty>

		 </dynamic>	)
	</insert>
	
	<update id="updateLoungePrice" parameterClass="loungePrice">
		UPDATE LOUNGE_PRICE
        <dynamic prepend="set">
		   <isNotEmpty prepend="," property="code">
              CODE=#code#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="roomId">
              ROOM_ID=#roomId#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="signingPrice">
              SIGNING_PRICE=#signingPrice#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="price">
              PRICE=#price#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="childrenPrice">
              CHILDREN_PRICE=#childrenPrice#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="item">
              ITEM=#item#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="type">
              TYPE=#type#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="way">
              WAY=#way#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="sts">
              STS=#sts#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="startDate">
              START_DATE=#startDate#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="endDate">
              END_DATE=#endDate#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="createUser">
              CREATE_USER=#createUser#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="createTime">
              CREATE_TIME=#createTime#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="updateUser">
              UPDATE_USER=#updateUser#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="updateTime">
              UPDATE_TIME=#updateTime#
           </isNotEmpty>
        </dynamic>
		WHERE 
               ID=#id#
	</update>	
	<delete id="deleteLoungePrice" parameterClass="java.lang.String">
		DELETE FROM LOUNGE_PRICE
		WHERE 
               ID=#id#
	</delete>	
</sqlMap>