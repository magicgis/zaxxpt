<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="orderLoungeRoom">
	<typeAlias alias="orderLoungeRoom" type="com.hnatourism.club.lounge.order.domain.OrderLoungeRoom" />
	<resultMap id="loungeOrderRoomResultMap" class="orderLoungeRoom">
		<result column="ID" property="id" />
		<result column="LOUNGE_ID" property="loungeId" />
		<result column="TYPE" property="type" />
		<result column="ROOM_TYPE" property="roomType" />
		<result column="STS" property="sts" />
		<result column="QUANTITY" property="quantity" />
		<result column="BOOK_DATE" property="bookDate" />
		<result column="START_TIME" property="startTime" />
		<result column="END_TIME" property="endTime" />
		<result column="ITEM" property="item" />
		<result column="START_DATE" property="startDate" />
		<result column="END_DATE" property="endDate" />
		<result column="RMK" property="rmk" />
		<result column="CREATE_USER" property="createUser" />
		<result column="CREATE_TIME" property="createTime" />
		<result column="UPDATE_USER" property="updateUser" />
		<result column="UPDATE_TIME" property="updateTime" />
		<result column="ID" property="loungePrice" select="findLoungePriceById"/>
	</resultMap>
	<resultMap id="loungeOrderRoomResultMapHome" class="orderLoungeRoom">
		<result column="ID" property="id" />
		<result column="LOUNGE_ID" property="loungeId" />
		<result column="TYPE" property="type" />
	</resultMap>
	
	<!-- 包括房间的最基本信息和数量信息 -->
	<resultMap id="loungeOrderRoomResultMapQ" class="orderLoungeRoom">
		<result column="ID" property="id" />
		<result column="LOUNGE_ID" property="loungeId" />
		<result column="QUANTITY" property="quantity" />
		<result column="TYPE" property="type" />
	</resultMap>
	
	<sql id="selectOrderLoungeRoomSql">
		<![CDATA[
			SELECT T.ID,T.LOUNGE_ID,T.TYPE,T.ROOM_TYPE,T.STS,T.QUANTITY,T.BOOK_DATE,T.START_TIME,T.END_TIME,T.ITEM,T.START_DATE,T.END_DATE,T.RMK,T.CREATE_USER,T.CREATE_TIME,T.UPDATE_USER,T.UPDATE_TIME 
			FROM LOUNGE_ROOM T
		]]>
	</sql>
	
	<!-- 查找休息室房间 -->
	<select id="findOrderLoungeRoomById" parameterClass="java.lang.String" resultMap="loungeOrderRoomResultMap">
		<include refid="selectLoungeRoomSql"/>	
		<![CDATA[
			WHERE T.ID=#id#
		]]>
	</select>
	
	<!-- 查询休息室对应的房间列表 -->
	<select id="findOrderLoungeRoomByLoungeId" parameterClass="java.lang.String" resultMap="loungeOrderRoomResultMapQ">
		<include refid="selectLoungeRoomSql"/>	
		<![CDATA[
			WHERE T.LOUNGE_ID=#loungeId#
		]]>
	</select>	
	
	<update id="updateOrderLoungeRoom" parameterClass="orderLoungeRoom">
		UPDATE LOUNGE_ROOM
        <dynamic prepend="set">
		   <isNotEmpty prepend="," property="loungeId">
              LOUNGE_ID=#loungeId#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="type">
              TYPE=#type#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="roomType">
              ROOM_TYPE=#roomType#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="sts">
              STS=#sts#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="quantity">
              QUANTITY=#quantity#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="bookDate">
              BOOK_DATE=#bookDate#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="startTime">
              START_TIME=#startTime#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="endTime">
              END_TIME=#endTime#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="item">
              ITEM=#item#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="startDate">
              START_DATE=#startDate#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="endDate">
              END_DATE=#endDate#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="rmk">
              RMK=#rmk#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="createUser">
              CREATE_USER=#createUser#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="createTime">
              CREATE_TIME=#createTime#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="updateUser">
              UPDATE_USER=#updateUser#
           </isNotEmpty>
		   <isNotEmpty prepend="," property="updateTime">
              UPDATE_TIME=#updateTime#
           </isNotEmpty>
        </dynamic>
		WHERE 
               ID=#id#
	</update>	
</sqlMap>